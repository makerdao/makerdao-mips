<div class="container">
  <div class="row">
    <div *ngIf="mip && !mip?.proposal">
      <span *ngIf="mip?.title" class="title-bold"
        >{{ mip?.mipName }}: </span
      ><span class="no-mobile title"> {{ mip?.title }}</span>
    </div>
    <div *ngIf="mip?.proposal">
      <span *ngIf="mip?.title" class="title-bold"
        >{{ subproposalCode }}: </span
      ><span class="no-mobile title"> {{ subproposalTitle }}</span>
    </div>
    <div *ngIf="mdUrl">
      <span class="title-bold">{{ titleMdFile?.split(":")[0] }}<span *ngIf="titleMdFile?.split(':')[1]">:</span></span
      ><span class="title"> {{ titleMdFile?.split(":")[1] }} </span>
    </div>

    <div *ngIf="mip" class="row social">
      <img class="github" src="../../../../../assets/images/github_dark.svg" />
      <a href="{{ gitgubUrl }}/{{ mip?.filename }}" target="_blank">GitHub</a>
      <img class="forum" src="../../../../../assets/images/forum.svg" />
      <a class="tooltip"
        >Forum<span class="tooltiptext"
          >Link to the forum coming soon. <br />
          Feel free to manually search the MIP number at <br />
          <a href="https://forum.makerdao.com/" target="_blank"
            >forum.makerdao.com</a
          >
        </span></a
      >
    </div>

    <div *ngIf="mdUrl" class="row social">
      <img class="linkIcon" src="../../../../../assets/images/open_gray.svg" />
      <a href="{{ urlOriginal }}" target="_blank">.md File</a>
    </div>
  </div>
  <!-- <div class="mobile title margin-2"> {{mip?.title}}</div> -->
  <div *ngIf="mip && !mip?.proposal" class="mobile title margin-2">
    <span class="title"> {{ mip?.title }}</span>
  </div>

  <div *ngIf="mip?.proposal" class="mobile title margin-2">
    <span class="title"> {{ subproposalTitle }}</span>
  </div>

  <hr />
  <markdown
    *ngIf="mip && !mdUrl"
    class="variable-binding"
    [data]="content"
    (error)="onError($error)"
    (ready)="onReady()"
  ></markdown>
  <markdown
    *ngIf="!mip && mdUrl"
    class="variable-binding"
    [src]="mdUrl"
    (error)="onError($error)"
    (ready)="onReady()"
  ></markdown>
</div>

<ng-template #preview let-data>
  <section
    class="preview"
    [ngClass]="{ fadeInFromDown: triangleUp, fadeInFromUp: !triangleUp }"
    #previewRef
  >
    <div
      class="smartLinksContainer"
      *ngIf="
        data.typeOfView === 'mipComponent' &&
        data.components &&
        data.components[0] &&
        data.components[0].cName
      "
    >
      <div class="mipComponentMipNameContainer">
        <div class="mipComponentLogoContainer">
          <img
            class="mipComponentLogo"
            src="../../../../../assets/images/makerLogo.svg"
          />
        </div>

        <div class="mipComponentMipName">
          <span *ngIf="data.mipName" class="spanCodeMip"
            >{{ data.mipName }}:</span
          >
          {{ data.title }}
        </div>
      </div>
      <div class="mipComponentMipSumary">
        <div class="rectangleContainer">
          <div class="thinRectangle"></div>
        </div>
        <div class="mipSumary">
          <markdown [data]="data.sentenceSummary"></markdown>
        </div>
      </div>
      <div class="mipComponentTitleContainer">
        <div class="rectangleContainer">
          <div class="thinRectangle"></div>
          <img
            class="mipComponentLogo"
            src=".../../../../../assets/images/mipComponentLogo.svg"
          />
        </div>
        <div class="mipComponentTitle">
          <span *ngIf="data.componentCode" class="spanCodeComponent"
            >{{ data.componentCode }}:</span
          >
          {{ data.components[0].cTitle }}
        </div>
      </div>
      <div class="mipComponenSumary">
        <div class="rectangleContainer">
          <div class="fadeThinRectangle"></div>
        </div>
        <div class="mipComponentSumary">
          <markdown [data]="data.components[0].cBody"></markdown>
        </div>
      </div>
      <div
        [ngClass]="{
          triangleUp: triangleUp,
          triangleDown: !triangleUp,
          centerX: triangleCenter,
          left: !triangleCenter && triangleLeft,
          right: !triangleCenter && !triangleLeft
        }"
      ></div>
    </div>
    <div *ngIf="data.typeOfView !== 'mipComponent'">
      <div class="previewTextTitle">{{ data.title }}</div>
      <div class="previewTextContent">
        <markdown [data]="data.sentenceSummary"></markdown>
      </div>
      <div
        [ngClass]="{
          triangleUp: triangleUp,
          triangleDown: !triangleUp,
          centerX: triangleCenter,
          left: !triangleCenter && triangleLeft,
          right: !triangleCenter && !triangleLeft
        }"
      ></div>
    </div>
  </section>
</ng-template>
